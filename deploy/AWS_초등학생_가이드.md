# 🎮 AWS에 우리 프로그램 올리기 - 초등학생도 할 수 있어요!

## 🤔 먼저 알아야 할 것들

### AWS가 뭐예요?
```
🏠 집에서 컴퓨터를 켜놓으면 전기세도 나오고, 컴퓨터가 고장날 수도 있어요.
☁️ AWS는 "아마존"이라는 회사가 운영하는 거대한 컴퓨터 빌딩이에요!
   우리가 돈을 조금 내면, 그 컴퓨터를 빌려서 쓸 수 있어요.
   
마치 🎮 PC방에서 컴퓨터를 빌려 쓰는 것과 비슷해요!
```

### 왜 AWS를 써요?
```
✅ 24시간 켜져 있어요 (우리 집 컴퓨터는 끄면 안 되잖아요)
✅ 전 세계 어디서든 접속할 수 있어요
✅ 고장나면 아마존이 고쳐줘요
✅ 처음 1년은 거의 무료예요! 🎉
```

---

## 📚 오늘 배울 내용

```
1️⃣ AWS 회원가입하기
2️⃣ 컴퓨터(EC2) 빌리기  
3️⃣ 컴퓨터에 접속하기
4️⃣ 우리 프로그램 설치하기
5️⃣ 프로그램 실행하기
6️⃣ 잘 되는지 확인하기
```

---

## 1️⃣ AWS 회원가입하기 (10분)

### 준비물
```
📧 이메일 주소
💳 신용카드 (부모님 도움 필요!)
📱 전화번호
```

### 따라하기

**1단계: AWS 홈페이지 가기**
```
🌐 인터넷 주소창에 입력하세요:
   https://aws.amazon.com/ko/
```

**2단계: 회원가입 버튼 클릭**
```
화면 오른쪽 위에 있는 [AWS 계정 생성] 버튼을 눌러요
```

**3단계: 정보 입력하기**
```
📧 이메일: 본인 이메일 입력
🔐 비밀번호: 어려운 비밀번호 만들기 (대문자+소문자+숫자+특수문자)
👤 계정 이름: 아무거나 (예: my-first-aws)
```

**4단계: 연락처 정보**
```
📍 계정 유형: "개인" 선택
📞 전화번호 입력
🏠 주소 입력
```

**5단계: 카드 등록**
```
💳 신용카드 정보 입력 (부모님과 함께!)
   ⚠️ 걱정 마세요! 1년간 무료 범위 안에서는 돈이 안 나가요
```

**6단계: 본인 확인**
```
📱 전화번호로 인증번호가 와요
   인증번호 4자리를 입력하세요
```

**7단계: 플랜 선택**
```
🆓 "기본 지원 - 무료" 선택
```

**🎉 축하해요! AWS 회원가입 완료!**

---

## 2️⃣ 컴퓨터(EC2) 빌리기 (15분)

### EC2가 뭐예요?
```
EC2 = Elastic Compute Cloud (탄력적 컴퓨터 구름)

쉽게 말하면: 🖥️ 인터넷에 있는 컴퓨터를 빌리는 거예요!

마치 레고 블록처럼, 필요할 때 컴퓨터를 만들고
필요 없으면 없앨 수 있어요!
```

### 따라하기

**1단계: AWS 콘솔 들어가기**
```
🌐 https://console.aws.amazon.com/ 접속
📧 이메일과 비밀번호로 로그인
```

**2단계: 지역 선택하기**
```
화면 오른쪽 위를 보세요!
"서울" 또는 "아시아 태평양(서울)"을 선택해요

🗺️ 왜 서울? 
   → 우리나라에서 가까운 컴퓨터를 쓰면 더 빨라요!
```

**3단계: EC2 찾기**
```
🔍 화면 위쪽 검색창에 "EC2" 입력
   → EC2 클릭!
```

**4단계: 인스턴스 시작하기**
```
🟠 주황색 [인스턴스 시작] 버튼 클릭!

💡 인스턴스 = 빌린 컴퓨터 1대
```

**5단계: 이름 짓기**
```
📝 이름: ls-hts-server

(우리 주식 프로그램 서버라는 뜻이에요)
```

**6단계: 운영체제 선택**
```
🐧 Ubuntu Server 22.04 LTS 선택

💡 Ubuntu = 리눅스라는 운영체제의 한 종류
   Windows 대신 쓰는 무료 운영체제예요!
```

**7단계: 컴퓨터 크기 선택**
```
📦 t2.micro 선택 (프리 티어 사용 가능이라고 써있어요!)

💡 t2.micro 스펙:
   - CPU: 1개
   - 메모리: 1GB
   - 무료! (1년간 매달 750시간)
```

**8단계: 열쇠(키 페어) 만들기** ⭐ 매우 중요!
```
🔑 [새 키 페어 생성] 클릭

   키 페어 이름: ls-hts-key
   키 페어 유형: RSA
   파일 형식: .pem

   [키 페어 생성] 클릭!

⬇️ ls-hts-key.pem 파일이 다운로드 돼요

⚠️ 이 파일은 컴퓨터 비밀번호 같은 거예요!
   절대 잃어버리면 안 돼요!
   안전한 폴더에 저장하세요!
```

**9단계: 네트워크 설정 (방화벽)**
```
🔥 방화벽 = 나쁜 사람이 못 들어오게 막는 벽

[편집] 버튼을 눌러서 다음을 추가해요:

✅ SSH (22번 포트) - 컴퓨터에 접속하는 문
✅ HTTP (80번 포트) - 웹사이트 보는 문  
✅ HTTPS (443번 포트) - 안전한 웹사이트 문

소스 유형: "위치 무관" 또는 "0.0.0.0/0" 선택
(어디서든 접속 가능하게)
```

**10단계: 저장 공간 설정**
```
💾 30 GiB 입력 (기본 8GB → 30GB로 변경)

💡 30GB = 영화 약 15편 정도 저장할 수 있는 공간
```

**11단계: 시작하기!**
```
🟠 [인스턴스 시작] 버튼 클릭!

⏳ 1-2분 기다리면...

🎉 컴퓨터가 만들어졌어요!
```

---

## 3️⃣ 컴퓨터에 접속하기 (10분)

### IP 주소 확인하기
```
EC2 대시보드에서 방금 만든 인스턴스를 클릭해요

📍 퍼블릭 IPv4 주소를 찾아요
   예: 13.125.xxx.xxx

이게 우리 컴퓨터의 "인터넷 주소"예요!
마치 집 주소처럼요 🏠
```

### Windows에서 접속하기

**방법 1: PowerShell 사용 (추천)**
```powershell
# 1. PowerShell을 관리자 권한으로 실행

# 2. 다운받은 키 파일이 있는 폴더로 이동
#    예: 다운로드 폴더에 있다면

# 3. 접속 명령어 입력
ssh -i "C:\Users\내이름\Downloads\ls-hts-key.pem" ubuntu@13.125.xxx.xxx

# 13.125.xxx.xxx 부분에 아까 확인한 IP 주소를 넣어요!
```

**방법 2: PuTTY 사용**
```
1. PuTTY 다운로드: https://www.putty.org/
2. PuTTYgen으로 .pem 파일을 .ppk로 변환
3. PuTTY에서 IP 주소 입력하고 접속
```

### 접속 성공하면 이렇게 보여요!
```
Welcome to Ubuntu 22.04 LTS

ubuntu@ip-172-31-xx-xx:~$ 

🎉 축하해요! AWS 컴퓨터에 들어왔어요!
```

---

## 4️⃣ 우리 프로그램 설치하기 (20분)

### 이제부터 AWS 컴퓨터 안에서 명령어를 입력해요!

**1단계: 컴퓨터 업데이트**
```bash
# 컴퓨터를 최신 상태로 만들어요
sudo apt update && sudo apt upgrade -y

# 💡 sudo = "슈퍼 유저로 실행해줘" (관리자 권한)
# 💡 apt = 프로그램 설치 도구
```

**2단계: Docker 설치**
```bash
# Docker = 프로그램을 쉽게 실행하게 해주는 마법 상자 📦

# Docker 설치 스크립트 다운로드
curl -fsSL https://get.docker.com -o get-docker.sh

# 설치 실행
sudo sh get-docker.sh

# 권한 설정 (다시 로그인 안 해도 Docker 쓸 수 있게)
sudo usermod -aG docker ubuntu
```

**3단계: Docker Compose 설치**
```bash
# Docker Compose = 여러 프로그램을 한번에 실행하는 도구

sudo curl -L "https://github.com/docker/compose/releases/latest/download/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose

sudo chmod +x /usr/local/bin/docker-compose
```

**4단계: 다시 접속하기**
```bash
# 설정을 적용하려면 다시 들어와야 해요
exit

# 다시 접속
ssh -i "ls-hts-key.pem" ubuntu@13.125.xxx.xxx
```

**5단계: 설치 확인**
```bash
# Docker가 잘 설치됐는지 확인
docker --version
# 결과: Docker version 24.x.x

docker-compose --version  
# 결과: Docker Compose version v2.x.x

# 둘 다 버전이 나오면 성공! 🎉
```

**6단계: Git 설치하고 프로젝트 다운로드**
```bash
# Git = 코드를 다운로드하는 도구
sudo apt install -y git

# 우리 프로젝트 다운로드
git clone https://github.com/greatjins/si-trading-system.git

# 프로젝트 폴더로 이동
cd si-trading-system
```

**7단계: 설정 파일 만들기**
```bash
# 환경 설정 파일 복사
cp .env.example .env

# LS증권 API 설정 파일 복사  
cp config.yaml.example config.yaml
```

**8단계: 설정 파일 수정하기**
```bash
# .env 파일 수정 (비밀번호 등)
nano .env

# 💡 nano = 메모장 같은 프로그램

# 수정할 내용:
# JWT_SECRET_KEY=아무거나긴문자열입력하세요12345
# POSTGRES_PASSWORD=비밀번호입력

# 저장하고 나가기: Ctrl+X → Y → Enter
```

```bash
# config.yaml 수정 (LS증권 API 키)
nano config.yaml

# 수정할 내용:
# ls_api:
#   app_key: "여기에_LS증권_앱키_입력"
#   app_secret: "여기에_LS증권_시크릿키_입력"

# 저장하고 나가기: Ctrl+X → Y → Enter
```

---

## 5️⃣ 프로그램 실행하기 (5분)

### 드디어 실행!
```bash
# 프로그램 빌드하고 실행하기
docker-compose -f deploy/docker-compose.prod.yml up --build -d

# 💡 -d = 백그라운드에서 실행 (창을 닫아도 계속 돌아가요)
```

### 실행 상태 확인
```bash
# 모든 프로그램이 잘 돌아가는지 확인
docker-compose -f deploy/docker-compose.prod.yml ps

# 이렇게 나오면 성공! ✅
# NAME        STATUS
# app         Up
# postgres    Up  
# redis       Up
# nginx       Up
```

### 로그 보기 (문제가 있을 때)
```bash
# 실시간 로그 보기
docker-compose -f deploy/docker-compose.prod.yml logs -f

# 나가기: Ctrl+C
```

---

## 6️⃣ 잘 되는지 확인하기

### 웹브라우저에서 확인
```
🌐 인터넷 주소창에 입력:
   http://13.125.xxx.xxx

   (아까 확인한 IP 주소)

🎉 화면이 나오면 성공!
```

### API 테스트
```bash
# 서버에서 직접 테스트
curl http://localhost/health

# 결과: {"status": "healthy"} 나오면 성공!
```

---

## 🎨 전체 과정 그림으로 보기

```
┌─────────────────────────────────────────────────────────────┐
│                     🌐 인터넷                                │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                    ☁️ AWS 클라우드                           │
│  ┌───────────────────────────────────────────────────────┐  │
│  │                   🖥️ EC2 (우리 서버)                   │  │
│  │                                                       │  │
│  │   ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐ │  │
│  │   │ 🌐      │  │ 🐍      │  │ 🐘      │  │ 🔴      │ │  │
│  │   │ Nginx   │→ │ FastAPI │→ │Postgres │  │ Redis   │ │  │
│  │   │ (문지기)│  │ (두뇌)  │  │(저장소) │  │(메모장) │ │  │
│  │   └─────────┘  └─────────┘  └─────────┘  └─────────┘ │  │
│  │                                                       │  │
│  └───────────────────────────────────────────────────────┘  │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                    📈 LS증권 API                             │
│              (주식 데이터를 가져오는 곳)                      │
└─────────────────────────────────────────────────────────────┘
```

### 각 부분이 하는 일
```
🌐 Nginx (엔진엑스)
   → 문지기 역할! 사람들이 들어오면 안내해줘요

🐍 FastAPI (파이썬 앱)
   → 두뇌 역할! 주식 전략을 계산하고 명령을 내려요

🐘 PostgreSQL (포스트그레스)
   → 창고 역할! 모든 데이터를 저장해요

🔴 Redis (레디스)
   → 메모장 역할! 자주 쓰는 것을 빨리 찾을 수 있게 해요
```

---

## 🆘 문제가 생겼을 때

### 문제 1: 메모리 부족 😵
```
증상: 프로그램이 자꾸 꺼져요

해결: 스왑 파일 만들기 (가상 메모리)
```
```bash
# 2GB 스왑 파일 만들기
sudo fallocate -l 2G /swapfile
sudo chmod 600 /swapfile
sudo mkswap /swapfile
sudo swapon /swapfile

# 재부팅해도 유지되게 설정
echo '/swapfile none swap sw 0 0' | sudo tee -a /etc/fstab
```

### 문제 2: 접속이 안 돼요 🔒
```
증상: 웹사이트가 안 열려요

확인할 것:
1. EC2 인스턴스가 "실행 중"인지 확인
2. 보안 그룹에서 80, 443 포트가 열려있는지 확인
3. IP 주소가 맞는지 확인
```

### 문제 3: Docker가 안 돼요 🐳
```bash
# Docker 서비스 재시작
sudo systemctl restart docker

# 권한 문제면
sudo usermod -aG docker ubuntu
# 그리고 다시 접속
```

---

## 💰 돈 이야기 (중요!)

### 무료로 쓸 수 있는 것 (1년간)
```
✅ EC2 t2.micro: 매달 750시간 무료
   (한 달 = 약 720시간이니까 1대는 무료!)
   
✅ 저장 공간: 30GB까지 무료

✅ 데이터 전송: 매달 15GB 무료
```

### 돈이 나갈 수 있는 경우 ⚠️
```
❌ t2.micro보다 큰 컴퓨터를 쓸 때
❌ 컴퓨터를 2대 이상 켜놓을 때  
❌ 1년이 지났을 때
❌ 저장 공간을 30GB 넘게 쓸 때
```

### 비용 확인하는 방법
```
1. AWS 콘솔 접속
2. 오른쪽 위 계정 이름 클릭
3. "결제 대시보드" 클릭
4. 현재까지 사용한 금액 확인!
```

---

## 🎯 정리: 오늘 배운 것

```
1️⃣ AWS = 인터넷에 있는 컴퓨터를 빌려 쓰는 서비스
2️⃣ EC2 = 빌린 컴퓨터
3️⃣ 키 페어 = 컴퓨터 비밀번호 (절대 잃어버리면 안 됨!)
4️⃣ Docker = 프로그램을 쉽게 실행하는 마법 상자
5️⃣ 보안 그룹 = 방화벽 (어떤 문을 열어줄지 정하는 것)
```

---

## 📝 명령어 모음 (복사해서 쓰세요!)

### 서버 접속
```powershell
ssh -i "C:\경로\ls-hts-key.pem" ubuntu@IP주소
```

### 프로그램 시작
```bash
cd si-trading-system
docker-compose -f deploy/docker-compose.prod.yml up -d
```

### 프로그램 중지
```bash
docker-compose -f deploy/docker-compose.prod.yml down
```

### 프로그램 재시작
```bash
docker-compose -f deploy/docker-compose.prod.yml restart
```

### 로그 보기
```bash
docker-compose -f deploy/docker-compose.prod.yml logs -f
```

### 상태 확인
```bash
docker-compose -f deploy/docker-compose.prod.yml ps
```

---

## 🌟 다음에 배울 것들

```
📌 도메인 연결하기 (IP 대신 예쁜 주소 쓰기)
📌 HTTPS 설정하기 (자물쇠 🔒 표시 나오게)
📌 자동 배포 설정하기 (코드 수정하면 자동으로 업데이트)
📌 백업 설정하기 (데이터 안전하게 보관)
```

---

**🎉 축하해요! 이제 여러분도 AWS 개발자예요!**

궁금한 게 있으면 언제든 물어보세요! 😊
