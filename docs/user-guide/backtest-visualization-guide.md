# 백테스트 시각화 사용자 가이드

## 목차
1. [개요](#개요)
2. [시작하기](#시작하기)
3. [백테스트 결과 분석](#백테스트-결과-분석)
4. [종목별 성과 분석](#종목별-성과-분석)
5. [거래 내역 분석](#거래-내역-분석)
6. [백테스트 비교](#백테스트-비교)
7. [차트 인터랙션](#차트-인터랙션)
8. [팁과 요령](#팁과-요령)

## 개요

백테스트 시각화 기능은 전략의 성과를 다양한 관점에서 분석할 수 있도록 도와주는 도구입니다. 자산 곡선, 종목별 성과, 거래 내역 등을 시각적으로 확인하고 전략의 강점과 약점을 파악할 수 있습니다.

### 주요 기능
- 📈 **자산 곡선 차트**: 시간에 따른 자산 변화 추이
- 📊 **종목별 성과 분석**: 각 종목의 수익률, 승률, 손익비 등
- 📋 **거래 내역 테이블**: 모든 거래의 상세 정보
- 📉 **가격 차트**: 매매 시점이 표시된 캔들스틱 차트
- 🔄 **백테스트 비교**: 여러 전략의 성과 비교

## 시작하기

### 1. 백테스트 실행
먼저 분석하고자 하는 전략의 백테스트를 실행합니다.

```python
# 백테스트 실행 예시
from core.backtest.engine import BacktestEngine
from strategies.moving_average import MovingAverageCrossover

# 전략 설정
strategy = MovingAverageCrossover(
    short_window=20,
    long_window=50
)

# 백테스트 실행
engine = BacktestEngine(
    initial_capital=10_000_000,
    start_date="2024-01-01",
    end_date="2024-12-31"
)

result = engine.run_backtest(strategy)
```

### 2. 결과 페이지 접속
백테스트 완료 후 결과 페이지로 이동합니다.
- URL: `/backtest/results/{backtest_id}`
- 백테스트 목록에서 "결과 보기" 버튼 클릭

## 백테스트 결과 분석

### 자산 곡선 차트
![자산 곡선 예시](../images/equity-curve-example.png)

자산 곡선 차트는 시간에 따른 포트폴리오 가치 변화를 보여줍니다.

#### 주요 요소
- **파란색 선**: 실제 자산 곡선
- **회색 선**: 초기 자본 기준선
- **빨간색 영역**: MDD(최대 낙폭) 구간
- **툴팁**: 마우스 오버 시 날짜와 자산 가치 표시

#### 분석 포인트
- **상승 추세**: 꾸준한 우상향 곡선이 이상적
- **변동성**: 곡선의 기울기 변화로 변동성 파악
- **MDD 구간**: 손실 구간의 깊이와 지속 기간 확인

### 성과 지표
결과 페이지 상단에 표시되는 주요 성과 지표들:

| 지표 | 설명 | 좋은 값 |
|------|------|---------|
| **총 수익률** | 전체 기간 수익률 | 양수, 높을수록 좋음 |
| **MDD** | 최대 낙폭 | 낮을수록 좋음 (5% 이하 우수) |
| **샤프 비율** | 위험 대비 수익률 | 1.0 이상 우수 |
| **승률** | 수익 거래 비율 | 50% 이상 양호 |
| **손익비** | 평균 수익/평균 손실 | 1.0 이상 필요 |

## 종목별 성과 분석

### 종목 리스트 테이블
![종목 리스트 예시](../images/symbol-list-example.png)

각 종목의 개별 성과를 확인할 수 있습니다.

#### 컬럼 설명
- **종목코드/종목명**: 거래한 종목 정보
- **수익률**: 해당 종목의 총 수익률 (%)
- **거래횟수**: 완결된 거래 횟수
- **승률**: 수익 거래 비율 (%)
- **손익비**: 평균 수익 / 평균 손실
- **총손익**: 해당 종목의 총 손익 (원)

#### 정렬 기능
- 컬럼 헤더 클릭으로 정렬 가능
- 화살표 아이콘으로 정렬 방향 표시
- 수익률 기준 내림차순이 기본값

#### 색상 코딩
- 🟢 **녹색**: 수익 (양수 값)
- 🔴 **빨간색**: 손실 (음수 값)
- 🟡 **주황색**: 승률 50% 미만
- 🟢 **녹색**: 승률 50% 이상

### 요약 정보
테이블 하단의 요약 정보:
- **총 종목 수**: 거래한 종목 개수
- **수익 종목**: 수익을 낸 종목 개수
- **손실 종목**: 손실을 낸 종목 개수
- **평균 수익률**: 모든 종목의 평균 수익률

## 거래 내역 분석

### 종목 상세 모달
종목을 클릭하면 상세 분석 모달이 열립니다.

![종목 상세 모달 예시](../images/symbol-detail-modal.png)

#### 구성 요소
1. **가격 차트**: 매매 시점이 표시된 캔들스틱 차트
2. **거래 내역 테이블**: 완결된 거래 목록
3. **추가 메트릭**: 평균 매수가, 평균 매도가, 평균 보유 기간

### 가격 차트 분석
![가격 차트 예시](../images/price-chart-example.png)

#### 차트 요소
- **캔들스틱**: 일별 OHLC 데이터
- **🟢 ↑ 매수 마커**: 매수 시점 표시
- **🔴 ↓ 매도 마커**: 매도 시점 표시
- **툴팁**: 마커 호버 시 거래 정보 표시

#### 분석 방법
1. **진입 타이밍**: 매수 마커가 적절한 위치에 있는지 확인
2. **청산 타이밍**: 매도 마커가 수익 구간에 있는지 확인
3. **보유 기간**: 진입과 청산 사이의 기간 분석
4. **가격 흐름**: 전체적인 가격 트렌드와 매매 시점 관계

### 거래 내역 테이블
![거래 내역 테이블 예시](../images/trade-history-example.png)

#### 컬럼 정보
- **진입일/청산일**: 거래 시작과 종료 날짜
- **진입가/청산가**: 매수가와 매도가
- **수량**: 거래 수량
- **수익률**: 개별 거래 수익률 (%)
- **손익**: 개별 거래 손익 (원)
- **보유기간**: 거래 보유 일수

#### 정렬 및 필터링
- 날짜, 수익률, 손익, 보유기간별 정렬 가능
- 수익/손실 거래 필터링
- 행 클릭 시 차트에서 해당 거래 하이라이트

## 백테스트 비교

### 비교 페이지 접속
1. 메뉴에서 "백테스트 비교" 선택
2. URL: `/backtest/compare`

### 비교 대상 선택
![비교 선택 예시](../images/comparison-selection.png)

1. 비교하고 싶은 백테스트들을 체크박스로 선택
2. "비교하기" 버튼 클릭
3. 최대 5개까지 동시 비교 가능

### 비교 차트 분석
![비교 차트 예시](../images/comparison-chart.png)

#### 차트 특징
- **다중 자산 곡선**: 각 전략별 색상으로 구분
- **범례**: 전략명과 최종 수익률 표시
- **최고 성과 하이라이트**: 가장 좋은 성과 강조
- **통합 툴팁**: 모든 전략의 동일 시점 값 표시

#### 비교 메트릭 테이블
| 전략 | 수익률 | MDD | 샤프비율 | 승률 | 손익비 |
|------|--------|-----|----------|------|--------|
| 전략 A | 15.2% | 8.1% | 1.25 | 65% | 2.1 |
| 전략 B | 12.8% | 5.3% | 1.18 | 58% | 1.8 |
| 전략 C | 18.5% | 12.2% | 1.35 | 72% | 2.5 |

## 차트 인터랙션

### 공통 기능
- **줌**: 마우스 휠로 확대/축소
- **팬**: 드래그로 차트 이동
- **리셋**: 더블클릭으로 원래 크기 복원
- **툴팁**: 마우스 오버로 상세 정보 표시

### 자산 곡선 차트
- **시간 범위 선택**: 드래그로 특정 기간 확대
- **MDD 구간 하이라이트**: 최대 낙폭 구간 시각화
- **기준선 표시**: 초기 자본 대비 성과 확인

### 가격 차트
- **매매 마커 클릭**: 해당 거래의 상세 정보 표시
- **시간축 동기화**: 거래 내역 테이블과 연동
- **볼륨 표시**: 거래량 정보 (선택적)

## 팁과 요령

### 효과적인 분석 방법

#### 1. 전체 → 세부 순서로 분석
1. **자산 곡선**으로 전체적인 성과 파악
2. **종목별 성과**로 개별 종목 기여도 확인
3. **거래 내역**으로 구체적인 매매 타이밍 분석

#### 2. 비교 분석 활용
- 여러 매개변수 조합 비교
- 다른 기간 백테스트 비교
- 벤치마크와 비교

#### 3. 주요 확인 포인트
- **일관성**: 꾸준한 수익 창출 여부
- **안정성**: MDD와 변동성 수준
- **효율성**: 샤프 비율과 손익비
- **다양성**: 여러 종목에서의 성과 분산

### 성과 개선 힌트

#### 수익률이 낮은 경우
- 종목별 성과에서 손실 종목 패턴 분석
- 진입/청산 타이밍 재검토
- 매개변수 최적화 고려

#### MDD가 높은 경우
- 손실 구간의 거래 패턴 분석
- 리스크 관리 규칙 강화
- 포지션 크기 조정

#### 승률이 낮은 경우
- 손실 거래의 공통점 찾기
- 진입 조건 엄격화
- 손절 규칙 개선

### 주의사항

#### 과최적화 방지
- 백테스트 기간을 다양하게 설정
- 아웃오브샘플 테스트 실시
- 실제 거래 환경과의 차이 고려

#### 데이터 품질 확인
- 가격 데이터의 정확성 검증
- 거래 수수료 반영 여부 확인
- 슬리피지 고려

#### 현실적 기대치 설정
- 과거 성과가 미래를 보장하지 않음
- 시장 환경 변화 고려
- 리스크 관리의 중요성 인식

## 문제 해결

### 자주 발생하는 문제

#### 차트가 로딩되지 않는 경우
1. 브라우저 새로고침
2. 캐시 삭제 후 재접속
3. 다른 브라우저로 시도

#### 데이터가 표시되지 않는 경우
1. 백테스트 실행 완료 여부 확인
2. 거래 데이터 존재 여부 확인
3. 서버 로그 확인

#### 성능이 느린 경우
1. 브라우저 탭 개수 줄이기
2. 다른 프로그램 종료
3. 데이터 범위 축소

### 지원 및 문의
- 📧 이메일: support@hts-platform.com
- 📞 전화: 02-1234-5678
- 💬 채팅: 웹사이트 우하단 채팅 버튼

---

이 가이드가 백테스트 결과 분석에 도움이 되기를 바랍니다. 추가 질문이나 개선 사항이 있으시면 언제든 문의해 주세요.